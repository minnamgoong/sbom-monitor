# SBOM 모니터링 시스템 요구사항

폐쇄망 환경에서 서버 내 SBOM 정보를 주기적으로 수집, 분석 및 관리하기 위한 시스템의 요구사항을 정의합니다.

## 1. 개요
내부 인프라(Black Duck, Nexus3, Syft)를 활용하여 서버의 소프트웨어 구성 요소를 투명하게 관리하고 보안 취약점을 지속적으로 모니터링합니다.

## 2. 주요 요구사항

### 2.1. 환경 및 배포 제약
- **VM 기반 환경**: 모든 대상 서버는 VM으로 구성되어 있습니다.
- **인프라 자동화 도구 미사용**: Terraform과 같은 코드형 인프라(IaC) 도구 사용이 불가합니다.
- **쉘 스크립트 기반 실행**: 각 서버에 접속하여 직접 쉘 스크립트(Shell Script)를 실행하는 방식으로 동작해야 합니다.
- **자산 및 스크립트 저장소**: 실행에 필요한 모든 스크립트 및 **Syft 바이너리**는 내부 Nexus3 저장소에 저장하고, 각 서버에서 다운로드하여 사용합니다. (Syft는 스크립트가 위치한 디렉토리 하위에 설치되어 관리됩니다.)

### 2.2. SBOM 수집 및 추출
- **anchore/syft 활용**: Nexus3에서 다운로드한 Syft 바이너리를 사용하여 서버 내 설치된 패키지 및 애플리케이션의 SBOM 정보를 추출합니다.
- **다중 타겟 디렉토리 지원**: 하나의 서버 내에 여러 개의 애플리케이션 또는 데이터 경로(1~n개)가 존재할 경우, 이를 모두 스캔 대상으로 등록하고 결과에 반영할 수 있어야 합니다.
- **자가 업데이트(Self-update)**: 스크립트 실행 시 Nexus3와 통신하여 최신 버전을 확인하고, 필요 시 스스로 스크립트 파일을 업데이트할 수 있어야 합니다.
- **Syft 자동 업데이트**: 스크립트뿐만 아니라 Syft 바이너리도 실행 시점에 최신 버전을 확인하여 자동으로 업데이트(다운로드 및 교체)되어야 합니다.
- **최초 실행 자동 설정**: 스크립트 최초 실행 시 시스템 환경에 맞는 Syft 다운로드, 스캔 대상 경로(들) 설정, 초기 스캔을 수행합니다.
- **권한 관리**: 시스템 폴더 접근 및 crontab 등록을 위해 **sudo 권한**을 사용하여 실행되어야 합니다.
- **주기적 스케줄링**: 초기 스캔 성공 시, 자동으로 **crontab**에 작업을 등록합니다.
    - **실행 주기**: 주 1회 (서버 부하 분산을 위해 서버마다 다른 요일에 실행)
    - **실행 시간대**: 비업무 시간 (오후 12시 ~ 오전 8시 사이 랜덤 실행)

- **분석 및 관리**: Black Duck (2025 version) 연동 및 수집 데이터 분석.
- **사용자 지정 프로젝트명**: 스크립트 최초 설정 시 Black Duck에 표시될 프로젝트명을 직접 지정할 수 있어야 합니다.
- **서버별 개별 이력 관리**: 각 서버의 호스트명(hostname)을 식별자로 사용하여 독립적인 이력을 관리합니다.
- **버전 규칙**: Black Duck 업로드 시 버전 명칭을 `{서버명}-{YYYYMMDDHHMMSS}` 형식으로 지정하여 시점별 이력을 추적합니다.
- **Black Duck 데이터 활용**: 최신 버전(2025)의 기능을 활용하여 효율적인 자산 관리를 수행합니다.

### 2.4. 아티팩트 및 자산 관리
- **Sonatype Nexus3 활용**: 시스템 실행에 필요한 **스크립트 및 Syft 바이너리**를 보관하고 배포하는 저장소 역할을 수행합니다. (SBOM 원본 파일의 중복 저장은 배제하고 Black Duck을 통해 통합 관리합니다.)

## 3. 기술 스택 (예정)
- **Scanning Tool**: anchore/syft
- **Security Analysis**: Black Duck (2025 version)
- **Storage**: Sonatype Nexus3
- **Scripting/Automation**: Python 또는 Bash 스크립트 기반
